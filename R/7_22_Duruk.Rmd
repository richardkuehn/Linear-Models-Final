---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(ggcorrplot)
library(grid)
library(vcd)
```



```{r}
df = expectancy = read.csv('~/Downloads/linear_models_project_data.csv')
head(df)
```

### Dropping NA values
```{r}

df = replace(df, df=="NaN", NA)
df = df %>% drop_na()
df %>% head()
```


# data cleaning
```{r}
df = replace(df, df=="<=50K.", "<=50K")
df = replace(df, df==">50K.", ">50K")

df %>% head()
```
# Collapsing some of the categories in the educatioin column
```{r}
df$education = replace(df$education, df$education=="1st-4th", "Elementary/Middle")
df$education = replace(df$education, df$education=="5th-6th", "Elementary/Middle")
df$education = replace(df$education, df$education=="7th-8th", "Elementary/Middle")
df$education = replace(df$education, df$education=="Preschool", "Elementary/Middle")
df$education = replace(df$education, df$education=="Assoc-acdm", "Associates")
df$education = replace(df$education, df$education=="Assoc-voc", "Associates")
df$education = replace(df$education, df$education=="9th", "Highschool")
df$education = replace(df$education, df$education=="10th", "Highschool")
df$education = replace(df$education, df$education=="11th", "Highschool")
df$education = replace(df$education, df$education=="12th", "Highschool")
df$education = replace(df$education, df$education=="HS-grad", "Highschool")


df
```



### showing how many rows we have
```{r}
nrow(df)
```


# How does the distribution of income vary across  different age groups?
```{r}
df$age_group <- cut(df$age, 
                      breaks = c(0, 20, 30, 40, 50, 60, 70, 80, Inf), 
                      labels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81+"), 
                      right = FALSE)

ggplot(df, aes(x = age_group, fill = income)) +
  geom_bar(position = "dodge") +
  labs(title = "Income Distribution Across Different Age Groups",
       x = "Age Group",
       y = "Count",
       fill = "Income")
```


# What is the relationship between the number of hours worked per week and income level?
```{r}
df %>% ggplot(aes(x=hours.per.week, y=income, color=income))+geom_boxplot()
```

# What is the relationship between the number of hours worked per week and income level?

```{r}
df %>% ggplot(aes(x=hours.per.week, y=income, color=income))+geom_violin()
```


# Converting income column into dummy variables
```{r}
data_dummies = fastDummies::dummy_cols(df, select_columns="income")
data_dummies
```

# Correlation between education number and income greater than 50K
```{r}
cor(data_dummies$education.num, data_dummies$`income_>50K`)
```

# Income level depending on education level
```{r}
data_dummies %>% ggplot(aes(x=education, fill=income))+geom_bar()+theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

# Income level depending on occupation type
```{r}
data_dummies %>% ggplot(aes(x=occupation, fill=income))+geom_bar()+theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



# Association between education level and income
```{r}

contingency_table = table(df$education, df$income)

chisq.test(contingency_table)


```

As we can see from the Chi-squared test, education and income has a very high association because the chi-square value is extremely high and p value is really low. This means that we have to reject null hypothesis and conclude that there is a high association between education and income.




